const https = require('https');
const cheerio = require('cheerio');
const request = require('request');
const fs = require('fs');
let url = 'http://www.iplant.cn/ashx/getfrps.ashx';
var subjectList = [{"code":"Acanthaceae","name":"爵床科"},{"code":"Aceraceae","name":"槭树科"},{"code":"Actinidiaceae","name":"猕猴桃科"},{"code":"Adoxaceae","name":"五福花科"},{"code":"Aizoaceae","name":"番杏科"},{"code":"Alangiaceae","name":"八角枫科"},{"code":"Alismataceae","name":"泽泻科"},{"code":"Amaranthaceae","name":"苋科"},{"code":"Amaryllidaceae","name":"石蒜科"},{"code":"Anacardiaceae","name":"漆树科"},{"code":"Ancistrocladaceae","name":"钩枝藤科"},{"code":"Annonaceae","name":"番荔枝科"},{"code":"Aponogetonaceae","name":"水蕹科"},{"code":"Aquifoliaceae","name":"冬青科"},{"code":"Araceae","name":"天南星科"},{"code":"Araliaceae","name":"五加科"},{"code":"Araucariaceae","name":"南洋杉科"},{"code":"Aristolochiaceae","name":"马兜铃科"},{"code":"Asclepiadaceae","name":"萝藦科"},{"code":"Balanophoraceae","name":"蛇菰科"},{"code":"Balsaminaceae","name":"凤仙花科"},{"code":"Basellaceae","name":"落葵科"},{"code":"Begoniaceae","name":"秋海棠科"},{"code":"Berberidaceae","name":"小檗科"},{"code":"Betulaceae","name":"桦木科"},{"code":"Bignoniaceae","name":"紫葳科"},{"code":"Bixaceae","name":"红木科"},{"code":"Bombacaceae","name":"木棉科"},{"code":"Boraginaceae","name":"紫草科"},{"code":"Bromeliaceae","name":"凤梨科"},{"code":"Burmanniaceae","name":"水玉簪科"},{"code":"Burseraceae","name":"橄榄科"},{"code":"Butomaceae","name":"花蔺科"},{"code":"Buxaceae","name":"黄杨科"},{"code":"Cabombaceae","name":"莼菜科"},{"code":"Cactaceae","name":"仙人掌科"},{"code":"Callitrichaceae","name":"水马齿科"},{"code":"Calycanthaceae","name":"蜡梅科"},{"code":"Campanulaceae","name":"桔梗科"},{"code":"Cannabaceae","name":"大麻科"},{"code":"Cannaceae","name":"美人蕉科"},{"code":"Caprifoliaceae","name":"忍冬科"},{"code":"Caricaceae","name":"番木瓜科"},{"code":"Caryophyllaceae","name":"石竹科"},{"code":"Casuarinaceae","name":"木麻黄科"},{"code":"Celastraceae","name":"卫矛科"},{"code":"Centrolepidaceae","name":"刺鳞草科"},{"code":"Cephalotaxaceae","name":"三尖杉科"},{"code":"Ceratophyllaceae","name":"金鱼藻科"},{"code":"Cercidiphyllaceae","name":"连香树科"},{"code":"Chenopodiaceae","name":"藜科"},{"code":"Chloranthaceae","name":"金粟兰科"},{"code":"Cistaceae","name":"半日花科"},{"code":"Clethraceae","name":"桤叶树科"},{"code":"Combretaceae","name":"使君子科"},{"code":"Commelinaceae","name":"鸭跖草科"},{"code":"Compositae","name":"菊科"},{"code":"Connaraceae","name":"牛栓藤科"},{"code":"Convolvulaceae","name":"旋花科"},{"code":"Coriariaceae","name":"马桑科"},{"code":"Cornaceae","name":"山茱萸科"},{"code":"Crassulaceae","name":"景天科"},{"code":"Crypteroniaceae","name":"隐翼科"},{"code":"Cucurbitaceae","name":"葫芦科"},{"code":"Cupressaceae","name":"柏科"},{"code":"Cycadaceae","name":"苏铁科"},{"code":"Cynomoriaceae","name":"锁阳科"},{"code":"Cyperaceae","name":"莎草科"},{"code":"Daphniphyllaceae","name":"虎皮楠科"},{"code":"Diapensiaceae","name":"岩梅科"},{"code":"Dichapetalaceae","name":"毒鼠子科"},{"code":"Dilleniaceae","name":"五桠果科"},{"code":"Dioscoreaceae","name":"薯蓣科"},{"code":"Dipsacaceae","name":"川续断科"},{"code":"Dipterocarpaceae","name":"龙脑香科"},{"code":"Droseraceae","name":"茅膏菜科"},{"code":"Ebenaceae","name":"柿科"},{"code":"Elaeagnaceae","name":"胡颓子科"},{"code":"Elaeocarpaceae","name":"杜英科"},{"code":"Elatinaceae","name":"沟繁缕科"},{"code":"Empetraceae","name":"岩高兰科"},{"code":"Ephedraceae","name":"麻黄科"},{"code":"Ericaceae","name":"杜鹃花科"},{"code":"Eriocaulaceae","name":"谷精草科"},{"code":"Erythroxylaceae","name":"古柯科"},{"code":"Eucommiaceae","name":"杜仲科"},{"code":"Euphorbiaceae","name":"大戟科"},{"code":"Eupteleaceae","name":"领春木科"},{"code":"Fagaceae","name":"壳斗科"},{"code":"Flacourtiaceae","name":"大风子科"},{"code":"Flagellariaceae","name":"须叶藤科"},{"code":"Frankeniaceae","name":"瓣鳞花科"},{"code":"Gentianaceae","name":"龙胆科"},{"code":"Geraniaceae","name":"牻牛儿苗科"},{"code":"Gesneriaceae","name":"苦苣苔科"},{"code":"Ginkgoaceae","name":"银杏科"},{"code":"Gnetaceae","name":"买麻藤科"},{"code":"Goodeniaceae","name":"草海桐科"},{"code":"Gramineae","name":"禾本科"},{"code":"Guttiferae","name":"藤黄科"},{"code":"Haloragidaceae","name":"小二仙草科"},{"code":"Hamamelidaceae","name":"金缕梅科"},{"code":"Hernandiaceae","name":"莲叶桐科"},{"code":"Hippocastanaceae","name":"七叶树科"},{"code":"Hippocrateaceae","name":"翅子藤科"},{"code":"Hippuridaceae","name":"杉叶藻科"},{"code":"Hydrocharitaceae","name":"水鳖科"},{"code":"Hydrophyllaceae","name":"田基麻科"},{"code":"Icacinaceae","name":"茶茱萸科"},{"code":"Iridaceae","name":"鸢尾科"},{"code":"Juglandaceae","name":"胡桃科"},{"code":"Juncaceae","name":"灯心草科"},{"code":"Labiatae","name":"唇形科"},{"code":"Lardizabalaceae","name":"木通科"},{"code":"Lauraceae","name":"樟科"},{"code":"Lecythidaceae","name":"玉蕊科"},{"code":"Leguminosae","name":"豆科"},{"code":"Lemnaceae","name":"浮萍科"},{"code":"Lentibulariaceae","name":"狸藻科"},{"code":"Liliaceae","name":"百合科"},{"code":"Linaceae","name":"亚麻科"},{"code":"Loganiaceae","name":"马钱科"},{"code":"Loranthaceae","name":"桑寄生科"},{"code":"Lythraceae","name":"千屈菜科"},{"code":"Magnoliaceae","name":"木兰科"},{"code":"Malpighiaceae","name":"金虎尾科"},{"code":"Malvaceae","name":"锦葵科"},{"code":"Marantaceae","name":"竹芋科"},{"code":"Martyniaceae","name":"角胡麻科"},{"code":"Melastomataceae","name":"野牡丹科"},{"code":"Meliaceae","name":"楝科"},{"code":"Menispermaceae","name":"防己科"},{"code":"Moraceae","name":"桑科"},{"code":"Moringaceae","name":"辣木科"},{"code":"Musaceae","name":"芭蕉科"},{"code":"Myoporaceae","name":"苦槛蓝科"},{"code":"Myricaceae","name":"杨梅科"},{"code":"Myristicaceae","name":"肉豆蔻科"},{"code":"Myrsinaceae","name":"紫金牛科"},{"code":"Myrtaceae","name":"桃金娘科"},{"code":"Najadaceae","name":"茨藻科"},{"code":"Nepenthaceae","name":"猪笼草科"},{"code":"Nyctaginaceae","name":"紫茉莉科"},{"code":"Nymphaeaceae","name":"睡莲科"},{"code":"Nyssaceae","name":"蓝果树科"},{"code":"Ochnaceae","name":"金莲木科"},{"code":"Olacaceae","name":"铁青树科"},{"code":"Oleaceae","name":"木犀科"},{"code":"Onagraceae","name":"柳叶菜科"},{"code":"Opiliaceae","name":"山柚子科"},{"code":"Orchidaceae","name":"兰科"},{"code":"Orobanchaceae","name":"列当科"},{"code":"Oxalidaceae","name":"酢浆草科"},{"code":"Palmae","name":"棕榈科"},{"code":"Pandaceae","name":"攀打科"},{"code":"Pandanaceae","name":"露兜树科"},{"code":"Papaveraceae","name":"罂粟科"},{"code":"Passifloraceae","name":"西番莲科"},{"code":"Pedaliaceae","name":"胡麻科"},{"code":"Pentaphylacaceae","name":"五列木科"},{"code":"Philydraceae","name":"田葱科"},{"code":"Phytolaccaceae","name":"商陆科"},{"code":"Pinaceae","name":"松科"},{"code":"Piperaceae","name":"胡椒科"},{"code":"Pittosporaceae","name":"海桐花科"},{"code":"Plantaginaceae","name":"车前科"},{"code":"Platanaceae","name":"悬铃木科"},{"code":"Plumbaginaceae","name":"白花丹科"},{"code":"Podocarpaceae","name":"罗汉松科"},{"code":"Podostemaceae","name":"川苔草科"},{"code":"Polemoniaceae","name":"花荵科"},{"code":"Polygalaceae","name":"远志科"},{"code":"Polygonaceae","name":"蓼科"},{"code":"Pontederiaceae","name":"雨久花科"},{"code":"Portulacaceae","name":"马齿苋科"},{"code":"Potamogetonaceae","name":"眼子菜科"},{"code":"Primulaceae","name":"报春花科"},{"code":"Proteaceae","name":"山龙眼科"},{"code":"Punicaceae","name":"石榴科"},{"code":"Pyrolaceae","name":"鹿蹄草科"},{"code":"Rafflesiaceae","name":"大花草科"},{"code":"Ranunculaceae","name":"毛茛科"},{"code":"Resedaceae","name":"木犀草科"},{"code":"Restionaceae","name":"帚灯草科"},{"code":"Rhamnaceae","name":"鼠李科"},{"code":"Rhizophoraceae","name":"红树科"},{"code":"Rhoipteleaceae","name":"马尾树科"},{"code":"Rosaceae","name":"蔷薇科"},{"code":"Rubiaceae","name":"茜草科"},{"code":"Rutaceae","name":"芸香科"},{"code":"Sabiaceae","name":"清风藤科"},{"code":"Salicaceae","name":"杨柳科"},{"code":"Salvadoraceae","name":"刺茉莉科"},{"code":"Santalaceae","name":"檀香科"},{"code":"Sapindaceae","name":"无患子科"},{"code":"Sapotaceae","name":"山榄科"},{"code":"Saururaceae","name":"三白草科"},{"code":"Saxifragaceae","name":"虎耳草科"},{"code":"Scheuchzeriaceae","name":"冰沼草科"},{"code":"Scrophulariaceae","name":"玄参科"},{"code":"Simaroubaceae","name":"苦木科"},{"code":"Solanaceae","name":"茄科"},{"code":"Sonneratiaceae","name":"海桑科"},{"code":"Sparganiaceae","name":"黑三棱科"},{"code":"Stachyuraceae","name":"旌节花科"},{"code":"Staphyleaceae","name":"省沽油科"},{"code":"Stemonaceae","name":"百部科"},{"code":"Sterculiaceae","name":"梧桐科"},{"code":"Stylidiaceae","name":"花柱草科"},{"code":"Styracaceae","name":"安息香科"},{"code":"Symplocaceae","name":"山矾科"},{"code":"Taccaceae","name":"蒟蒻薯科"},{"code":"Tamaricaceae","name":"柽柳科"},{"code":"Taxaceae","name":"红豆杉科"},{"code":"Taxodiaceae","name":"杉科"},{"code":"Theaceae","name":"山茶科"},{"code":"Theligonaceae","name":"假繁缕科"},{"code":"Thymelaeaceae","name":"瑞香科"},{"code":"Tiliaceae","name":"椴树科"},{"code":"Trapaceae","name":"菱科"},{"code":"Triuridaceae","name":"霉草科"},{"code":"Trochodendraceae","name":"昆栏树科"},{"code":"Tropaeolaceae","name":"旱金莲科"},{"code":"Typhaceae","name":"香蒲科"},{"code":"Ulmaceae","name":"榆科"},{"code":"Umbelliferae","name":"伞形科"},{"code":"Urticaceae","name":"荨麻科"},{"code":"Valerianaceae","name":"败酱科"},{"code":"Verbenaceae","name":"马鞭草科"},{"code":"Violaceae","name":"堇菜科"},{"code":"Vitaceae","name":"葡萄科"},{"code":"Xyridaceae","name":"黄眼草科"},{"code":"Zingiberaceae","name":"姜科"},{"code":"Zygophyllaceae","name":"蒺藜科"}]

var worm = function (key, index) {
	let urlResult = url + '?key=' + key
	let idx = index + 1
	request(urlResult, function (error, response, body) {
	   if (body !== '') {
		   let data = JSON.parse(body)
		   let dataStr = data.frpsdesc + data.frpskey
		   fs.writeFile('./text/subject.html', dataStr, { 'flag': 'a' }, function(err) {
		       if(err) throw err;
		       console.log('写入成功第' + idx + '');
		   });
	   }
	})
}
subjectList.forEach((v, index) => {
	setTimeout(() => {
		worm(v.code, index)
	}, 2000)
})